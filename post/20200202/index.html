<!doctype html><html lang=ko dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>파이썬으로 쿠팡 파트너스 API 활용하기 - 3 네이버 블로그 API로 글올리기 | Jaejin's blog</title>
<meta name=keywords content="python,쿠팡파트너스,coupangpartners"><meta name=description content="이력 2020.02.02 포스팅 안녕하세요. 많이 늦었죠? ㅎㅎ, 쓰기가 너무 귀찮아요..ㅋㅋ 사실 요즘에는 쿠팡 상품도 안올리고 있어요. 귀찬쓰.. 아무튼 오늘도 시작하겠습니"><meta name=author content="Jaejin Jang"><link rel=canonical href=https://jaejin0me.github.io/post/20200202/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://jaejin0me.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jaejin0me.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jaejin0me.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jaejin0me.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jaejin0me.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=ko href=https://jaejin0me.github.io/post/20200202/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-F8504X956T"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-F8504X956T",{anonymize_ip:!0})}</script><meta property="og:title" content="파이썬으로 쿠팡 파트너스 API 활용하기 - 3 네이버 블로그 API로 글올리기"><meta property="og:description" content="이력 2020.02.02 포스팅 안녕하세요. 많이 늦었죠? ㅎㅎ, 쓰기가 너무 귀찮아요..ㅋㅋ 사실 요즘에는 쿠팡 상품도 안올리고 있어요. 귀찬쓰.. 아무튼 오늘도 시작하겠습니"><meta property="og:type" content="article"><meta property="og:url" content="https://jaejin0me.github.io/post/20200202/"><meta property="article:section" content="post"><meta property="article:published_time" content="2020-02-02T07:12:52+09:00"><meta property="article:modified_time" content="2020-02-02T07:12:52+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="파이썬으로 쿠팡 파트너스 API 활용하기 - 3 네이버 블로그 API로 글올리기"><meta name=twitter:description content="이력 2020.02.02 포스팅 안녕하세요. 많이 늦었죠? ㅎㅎ, 쓰기가 너무 귀찮아요..ㅋㅋ 사실 요즘에는 쿠팡 상품도 안올리고 있어요. 귀찬쓰.. 아무튼 오늘도 시작하겠습니"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://jaejin0me.github.io/post/"},{"@type":"ListItem","position":2,"name":"파이썬으로 쿠팡 파트너스 API 활용하기 - 3 네이버 블로그 API로 글올리기","item":"https://jaejin0me.github.io/post/20200202/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"파이썬으로 쿠팡 파트너스 API 활용하기 - 3 네이버 블로그 API로 글올리기","name":"파이썬으로 쿠팡 파트너스 API 활용하기 - 3 네이버 블로그 API로 글올리기","description":"이력 2020.02.02 포스팅 안녕하세요. 많이 늦었죠? ㅎㅎ, 쓰기가 너무 귀찮아요..ㅋㅋ 사실 요즘에는 쿠팡 상품도 안올리고 있어요. 귀찬쓰.. 아무튼 오늘도 시작하겠습니","keywords":["python","쿠팡파트너스","coupangpartners"],"articleBody":"이력\n2020.02.02 포스팅 안녕하세요.\n많이 늦었죠? ㅎㅎ, 쓰기가 너무 귀찮아요..ㅋㅋ\n사실 요즘에는 쿠팡 상품도 안올리고 있어요. 귀찬쓰..\n아무튼 오늘도 시작하겠습니다. 과정이 길게 느껴질수도 있는데,\n어렵지는 않아요. 하나하나 따라 하시면 금방하실 수 있어요.\n이번 포스트에서 설명할 내용 네이버 블로그 API 이용해서 글 올리기 네이버 블로그 API 글쓰기 절차 네이버 블로그 API 신청 ( = 애플리케이션 등록) API 정보 확인 하기 (Client ID, Client Secret 확인) 파이썬으로 블로그 API 활용해 글 올리기 1. 네이버 블로그 API 신청 ( = 애플리케이션 등록) API를 사용하려면 우선 API 사용신청을 해야 겠죠? 아래의 링크를 타고 들어가서 오픈 API 이용신청을 누르세요. 링크 : https://developers.naver.com/products/blog/ 그러면 이제 신청화면이 나옵니다. 이름은 원하는대로 설정하시면 됩니다. 사용 API는 수정하실께 없어요. 이미 우리가 사용할 네아로, 블로그가 설정되어 있으니까요. 로그인 오픈 API 서비스 환경은 PC 웹을 선택하시면 됩니다. PC 웹을 선택 하시면 서비스 URL, 네이버아이디로로그인 CallBack URL을 설정하는 메뉴가 나옵니다. 우리가 실질적으로 사용할 URL은 네아로(네이버아이디로로그인) CallBack URL 이에요. 설정은 아래의 그림과 같이 하시면 됩니다. 간단하게 설명을 드리면, 우리가 어떤 URL로 접속을 했을때 서비스를 받을 수 있는지 설정을 한거에요. 서비스 URL은 어차피 사용을 안하기 때문에 채우기만 했습니다. 중요한 것은 네아로 CallBackURL 입니다. 우리가 네아로 API를 호출하면, API 호출을 하기 위한 값(토큰)을 받게 되는데요. 그 토큰을 저기에 적은 “http://localhost:8080/” 로 받겠다는 의미입니다. localhost는 본인의 컴퓨터의 주소, 8080은 포트를 말합니다. 우리는 각자 본인의 PC로 개발을 하고 있으니까, 본인 PC의 8080 포트로 받도록 설정을 합것입니다. 8080에 큰 의미는 없습니다^^(일반적으로 많이 쓰이는 포트이긴한데, 그것까지 아실 정도면 이 글을 안보셔도 될 분들이실꺼 같아요..ㅎ) 이렇게 설정을 하고 신청을 하시면 블로그 API를 사용하기 위한 신청은 끝났습니다.\n2. API 정보 확인 하기 (Client ID, Client Secret 확인) 겁내 쉽습니다. 그냥 들어가서 확인하시면 되요. API 등록(애플리케이션 등록)을 하셨으면 “내 애플리케이션” 목록에서 등록하신 애플리케이션을 확인하실 수 있습니다. 만약에 “Test\"라는 이름으로 등록했다면 아래의 그림과 같이 나오겠죠? 저기서 Client ID, Client Secret을 확인하시면 됩니다. 쿠팡 API랑 비슷하죠 ㅎㅎ?. 사실 API사용은 다 똑같아요. 각자 본인의 스타일대로 만드는게 아니라, 항상 일정한 표준에 맞게 만들어집니다. 그래야 쓰기가 쉽고, 사람들도 많이 써서 활용도 많이 되고 하죠 ㅎㅎ 3. 파이썬으로 블로그 API 활용해 글 올리기 API를 활용하기 위한 정보도 알았겠다. 이제 사용하기만 하면됩니다. 코딩 Time~ 저는 간단하게 사용하는 방법만 알려드릴껀데요. 여러가지 사용방법은 아래의 블로그 API 명세를 보시면 확인할 수 있습니다. 블로그 API 명세 : https://developers.naver.com/docs/blog/post/ 코드의 흐름 a. 네아로 API를 호출해 블로그 API 호출을 위한 토큰을 얻는다. b. a에서 받은 토큰으로 블로그 API를 호출한다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 # coding: utf-8 import sys import os import urllib.request import requests import json import re from selenium import webdriver from urllib.parse import urlencode __author__ = \"Jaejin Jang\" class naverMgr: def __init__(self, **kwargs): self.options = webdriver.ChromeOptions() self.options.add_argument('headless') self.options.add_argument(\"user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36\") self.webdriverpath = os.getcwd() + r\"\\chromedriver.exe\" def get_logintoken(self, id, pw, cid, csec, cburl): driver = webdriver.Chrome(self.webdriverpath, options=self.options) driver.implicitly_wait(5) driver.get('https://nid.naver.com/nidlogin.login') driver.execute_script(\"document.getElementsByName('id')[0].value=\\'\"+ id + \"\\'\") driver.execute_script(\"document.getElementsByName('pw')[0].value=\\'\"+ pw + \"\\'\") driver.find_element_by_xpath('//*[@id=\"label_login_chk\"]').click() driver.find_element_by_xpath('//*[@id=\"frmNIDLogin\"]/fieldset/input').click() driver.implicitly_wait(10) state = \"TEST\" #아무거나 상관없음 req_url = 'https://nid.naver.com/oauth2.0/authorize?response_type=code\u0026client_id=%s\u0026redirect_uri=%s\u0026state=%s' % (cid, cburl, state) response = requests.request(method='GET', url=req_url, headers={ \"Content-Type\": \"application/json;charset=UTF-8\" }) driver.get(req_url) driver.implicitly_wait(5) # 첫 실행시 블로그글쓰기 권한 체크위해를 위한 코드 try: driver.find_element_by_xpath('//*[@id=\"profile_optional_list\"]/span/label').click() driver.find_element_by_xpath('//*[@id=\"content\"]/div[4]/div[2]/button').click() except: pass redirect_url = driver.current_url temp = re.split('code=', redirect_url) code = re.split('\u0026state=', temp[1])[0] driver.quit() url = 'https://nid.naver.com/oauth2.0/token?' data = 'grant_type=authorization_code' + '\u0026client_id=' + cid + '\u0026client_secret=' + csec + '\u0026redirect_uri=' + cburl + '\u0026code=' + code + '\u0026state=' + state request = urllib.request.Request(url, data=data.encode(\"utf-8\")) request.add_header('X-Naver-Client-Id', cid) request.add_header('X-Naver-Client-Secret', cburl) response = urllib.request.urlopen(request) rescode = response.getcode() if rescode == 200: response_body = response.read() js = json.loads(response_body.decode('utf 8')) token = js['access_token'] return token else: print(\"Error Code:\", rescode) return \"\" def write_product(self, blogtoken, title, contents): blogheader = \"Bearer \" + blogtoken # Bearer 다음에 공백 추가 blogwriteapi = \"https://openapi.naver.com/blog/writePost.json\" blogdata = {'title': title, 'contents': contents} blogheaders = {'Authorization': blogheader } response = requests.post(blogwriteapi, headers=blogheaders, data=blogdata) rescode = response.status_code return rescode if __name__ == '__main__': id = '' pw = '' client_id = '' client_secret = '' callback_url = 'http://localhost:8080/' nav = naverMgr() token = nav.get_logintoken(id, pw, client_id, client_secret, callback_url) title = '제목' contents = '내용' ret = nav.write_product(token, title, contents) if (ret == 200): print('성공') else: print('실패') pass 테스트한 결과 정상적으로 업로드 잘 되네요. 다음 포스트에서 설명할 내용\n다음 포스트에서는 쿠팡의 리뷰 가져오기는 알려드릴 예정입니다. 혹시나 알려줬으면~ 하는게 있으시면 댓글로 달아 주세요. 모두에게 중요하다 싶은게 있으면 같이 업로드 하겠습니다! ","wordCount":"1763","inLanguage":"ko","datePublished":"2020-02-02T07:12:52+09:00","dateModified":"2020-02-02T07:12:52+09:00","author":{"@type":"Person","name":"Jaejin Jang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jaejin0me.github.io/post/20200202/"},"publisher":{"@type":"Organization","name":"Jaejin's blog","logo":{"@type":"ImageObject","url":"https://jaejin0me.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jaejin0me.github.io/ accesskey=h title="Jaejin's blog (Alt + H)">Jaejin's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://jaejin0me.github.io/ title=Home><span>Home</span></a></li><li><a href=https://jaejin0me.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://jaejin0me.github.io/post/ title=Posts><span>Posts</span></a></li><li><a href=https://jaejin0me.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://jaejin0me.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://jaejin0me.github.io/about/ title="About Me"><span>About Me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>파이썬으로 쿠팡 파트너스 API 활용하기 - 3 네이버 블로그 API로 글올리기</h1><div class=post-meta>&lt;span title='2020-02-02 07:12:52 +0900 +0900'>2월 2, 2020&lt;/span>&amp;nbsp;·&amp;nbsp;Jaejin Jang</div></header><div class=post-content><p>이력</p><ul><li>2020.02.02 포스팅</li></ul><p><em>안녕하세요.<br>많이 늦었죠? ㅎㅎ, 쓰기가 너무 귀찮아요..ㅋㅋ<br>사실 요즘에는 쿠팡 상품도 안올리고 있어요. 귀찬쓰..<br>아무튼 오늘도 시작하겠습니다. 과정이 길게 느껴질수도 있는데,<br>어렵지는 않아요. 하나하나 따라 하시면 금방하실 수 있어요.</em></p><h1 id=이번-포스트에서-설명할-내용>이번 포스트에서 설명할 내용<a hidden class=anchor aria-hidden=true href=#이번-포스트에서-설명할-내용>#</a></h1><ul><li>네이버 블로그 API 이용해서 글 올리기</li></ul><h1 id=네이버-블로그-api-글쓰기-절차>네이버 블로그 API 글쓰기 절차<a hidden class=anchor aria-hidden=true href=#네이버-블로그-api-글쓰기-절차>#</a></h1><ul><li><ol><li>네이버 블로그 API 신청 ( = 애플리케이션 등록)</li></ol></li><li><ol start=2><li>API 정보 확인 하기 (Client ID, Client Secret 확인)</li></ol></li><li><ol start=3><li>파이썬으로 블로그 API 활용해 글 올리기</li></ol></li></ul><h2 id=1-네이버-블로그-api-신청---애플리케이션-등록>1. 네이버 블로그 API 신청 ( = 애플리케이션 등록)<a hidden class=anchor aria-hidden=true href=#1-네이버-블로그-api-신청---애플리케이션-등록>#</a></h2><ul><li>API를 사용하려면 우선 API 사용신청을 해야 겠죠? 아래의 링크를 타고 들어가서 오픈 API 이용신청을 누르세요.</li><li>링크 : <a href=https://developers.naver.com/products/blog/>https://developers.naver.com/products/blog/</a>
<img loading=lazy src=/20200202_2.png alt=신청누르기 title=신청누르기></li><li>그러면 이제 신청화면이 나옵니다. 이름은 원하는대로 설정하시면 됩니다. 사용 API는 수정하실께 없어요.</li><li>이미 우리가 사용할 네아로, 블로그가 설정되어 있으니까요. 로그인 오픈 API 서비스 환경은 PC 웹을 선택하시면 됩니다.
<img loading=lazy src=/20200202_1.png alt="API 신청 설정하기" title="API 신청 설정하기"></li><li>PC 웹을 선택 하시면 서비스 URL, 네이버아이디로로그인 CallBack URL을 설정하는 메뉴가 나옵니다.</li><li>우리가 실질적으로 사용할 URL은 네아로(네이버아이디로로그인) CallBack URL 이에요. 설정은 아래의 그림과 같이 하시면 됩니다.
<img loading=lazy src=/20200202_3.png alt="URL 설정하기" title="URL 설정하기"></li><li>간단하게 설명을 드리면, 우리가 어떤 URL로 접속을 했을때 서비스를 받을 수 있는지 설정을 한거에요.</li><li>서비스 URL은 어차피 사용을 안하기 때문에 채우기만 했습니다. 중요한 것은 네아로 CallBackURL 입니다.</li><li>우리가 네아로 API를 호출하면, API 호출을 하기 위한 값(토큰)을 받게 되는데요.</li><li>그 토큰을 저기에 적은 &ldquo;http://localhost:8080/&rdquo; 로 받겠다는 의미입니다. localhost는 본인의 컴퓨터의 주소, 8080은 포트를 말합니다.</li><li>우리는 각자 본인의 PC로 개발을 하고 있으니까, 본인 PC의 8080 포트로 받도록 설정을 합것입니다.</li><li>8080에 큰 의미는 없습니다^^(일반적으로 많이 쓰이는 포트이긴한데, 그것까지 아실 정도면 이 글을 안보셔도 될 분들이실꺼 같아요..ㅎ)</li></ul><p>이렇게 설정을 하고 신청을 하시면 블로그 API를 사용하기 위한 신청은 끝났습니다.</p><h2 id=2-api-정보-확인-하기-client-id-client-secret-확인>2. API 정보 확인 하기 (Client ID, Client Secret 확인)<a hidden class=anchor aria-hidden=true href=#2-api-정보-확인-하기-client-id-client-secret-확인>#</a></h2><ul><li>겁내 쉽습니다. 그냥 들어가서 확인하시면 되요.</li><li>API 등록(애플리케이션 등록)을 하셨으면 &ldquo;내 애플리케이션&rdquo; 목록에서 등록하신 애플리케이션을 확인하실 수 있습니다.</li><li>만약에 &ldquo;Test"라는 이름으로 등록했다면 아래의 그림과 같이 나오겠죠? 저기서 Client ID, Client Secret을 확인하시면 됩니다.</li><li>쿠팡 API랑 비슷하죠 ㅎㅎ?. 사실 API사용은 다 똑같아요. 각자 본인의 스타일대로 만드는게 아니라, 항상 일정한 표준에 맞게 만들어집니다.</li><li>그래야 쓰기가 쉽고, 사람들도 많이 써서 활용도 많이 되고 하죠 ㅎㅎ
<img loading=lazy src=/20200202_4.png alt="API 정보확인" title="API 정보확인"></li></ul><h2 id=3-파이썬으로-블로그-api-활용해-글-올리기>3. 파이썬으로 블로그 API 활용해 글 올리기<a hidden class=anchor aria-hidden=true href=#3-파이썬으로-블로그-api-활용해-글-올리기>#</a></h2><ul><li>API를 활용하기 위한 정보도 알았겠다. 이제 사용하기만 하면됩니다. 코딩 Time~</li><li>저는 간단하게 사용하는 방법만 알려드릴껀데요. 여러가지 사용방법은 아래의 블로그 API 명세를 보시면 확인할 수 있습니다.</li><li>블로그 API 명세 : <a href=https://developers.naver.com/docs/blog/post/>https://developers.naver.com/docs/blog/post/</a></li></ul><h3 id=코드의-흐름>코드의 흐름<a hidden class=anchor aria-hidden=true href=#코드의-흐름>#</a></h3><ul><li>a. 네아로 API를 호출해 블로그 API 호출을 위한 토큰을 얻는다.</li><li>b. a에서 받은 토큰으로 블로그 API를 호출한다.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span><span class=lnt>97
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># coding: utf-8</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>urllib.request</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>urllib.parse</span> <span class=kn>import</span> <span class=n>urlencode</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>__author__</span> <span class=o>=</span> <span class=s2>&#34;Jaejin Jang&lt;jaejin_me@naver.com&gt;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>naverMgr</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=bp>self</span><span class=o>.</span><span class=n>options</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>ChromeOptions</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=bp>self</span><span class=o>.</span><span class=n>options</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;headless&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=bp>self</span><span class=o>.</span><span class=n>options</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&#34;user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=bp>self</span><span class=o>.</span><span class=n>webdriverpath</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>()</span> <span class=o>+</span> <span class=sa>r</span><span class=s2>&#34;\chromedriver.exe&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>def</span> <span class=nf>get_logintoken</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=nb>id</span><span class=p>,</span> <span class=n>pw</span><span class=p>,</span> <span class=n>cid</span><span class=p>,</span> <span class=n>csec</span><span class=p>,</span> <span class=n>cburl</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=n>driver</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>webdriverpath</span><span class=p>,</span> <span class=n>options</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>options</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>driver</span><span class=o>.</span><span class=n>implicitly_wait</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://nid.naver.com/nidlogin.login&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>driver</span><span class=o>.</span><span class=n>execute_script</span><span class=p>(</span><span class=s2>&#34;document.getElementsByName(&#39;id&#39;)[0].value=</span><span class=se>\&#39;</span><span class=s2>&#34;</span><span class=o>+</span> <span class=nb>id</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\&#39;</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>driver</span><span class=o>.</span><span class=n>execute_script</span><span class=p>(</span><span class=s2>&#34;document.getElementsByName(&#39;pw&#39;)[0].value=</span><span class=se>\&#39;</span><span class=s2>&#34;</span><span class=o>+</span> <span class=n>pw</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\&#39;</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>driver</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;label_login_chk&#34;]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=n>driver</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;frmNIDLogin&#34;]/fieldset/input&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=n>driver</span><span class=o>.</span><span class=n>implicitly_wait</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		<span class=n>state</span> <span class=o>=</span> <span class=s2>&#34;TEST&#34;</span> <span class=c1>#아무거나 상관없음</span>
</span></span><span class=line><span class=cl>		<span class=n>req_url</span> <span class=o>=</span> <span class=s1>&#39;https://nid.naver.com/oauth2.0/authorize?response_type=code&amp;client_id=</span><span class=si>%s</span><span class=s1>&amp;redirect_uri=</span><span class=si>%s</span><span class=s1>&amp;state=</span><span class=si>%s</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=n>cid</span><span class=p>,</span> <span class=n>cburl</span><span class=p>,</span> <span class=n>state</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>request</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=n>url</span><span class=o>=</span><span class=n>req_url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=p>{</span> <span class=s2>&#34;Content-Type&#34;</span><span class=p>:</span> <span class=s2>&#34;application/json;charset=UTF-8&#34;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>req_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>driver</span><span class=o>.</span><span class=n>implicitly_wait</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=c1># 첫 실행시 블로그글쓰기 권한 체크위해를 위한 코드</span>
</span></span><span class=line><span class=cl>		<span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=n>driver</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;profile_optional_list&#34;]/span/label&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>			<span class=n>driver</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s1>&#39;//*[@id=&#34;content&#34;]/div[4]/div[2]/button&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=k>pass</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		<span class=n>redirect_url</span> <span class=o>=</span> <span class=n>driver</span><span class=o>.</span><span class=n>current_url</span>
</span></span><span class=line><span class=cl>		<span class=n>temp</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;code=&#39;</span><span class=p>,</span> <span class=n>redirect_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>code</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;&amp;state=&#39;</span><span class=p>,</span> <span class=n>temp</span><span class=p>[</span><span class=mi>1</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>		<span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		<span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;https://nid.naver.com/oauth2.0/token?&#39;</span>
</span></span><span class=line><span class=cl>		<span class=n>data</span> <span class=o>=</span> <span class=s1>&#39;grant_type=authorization_code&#39;</span> <span class=o>+</span> <span class=s1>&#39;&amp;client_id=&#39;</span> <span class=o>+</span> <span class=n>cid</span> <span class=o>+</span> <span class=s1>&#39;&amp;client_secret=&#39;</span> <span class=o>+</span> <span class=n>csec</span> <span class=o>+</span> <span class=s1>&#39;&amp;redirect_uri=&#39;</span> <span class=o>+</span> <span class=n>cburl</span> <span class=o>+</span> <span class=s1>&#39;&amp;code=&#39;</span> <span class=o>+</span> <span class=n>code</span> <span class=o>+</span> <span class=s1>&#39;&amp;state=&#39;</span> <span class=o>+</span> <span class=n>state</span>
</span></span><span class=line><span class=cl>		<span class=n>request</span> <span class=o>=</span> <span class=n>urllib</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>Request</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		<span class=n>request</span><span class=o>.</span><span class=n>add_header</span><span class=p>(</span><span class=s1>&#39;X-Naver-Client-Id&#39;</span><span class=p>,</span> <span class=n>cid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>request</span><span class=o>.</span><span class=n>add_header</span><span class=p>(</span><span class=s1>&#39;X-Naver-Client-Secret&#39;</span><span class=p>,</span> <span class=n>cburl</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=n>response</span> <span class=o>=</span> <span class=n>urllib</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>rescode</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>getcode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=n>rescode</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=n>response_body</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>			<span class=n>js</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>response_body</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf 8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>			<span class=n>token</span> <span class=o>=</span> <span class=n>js</span><span class=p>[</span><span class=s1>&#39;access_token&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>			<span class=k>return</span> <span class=n>token</span>
</span></span><span class=line><span class=cl>		<span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error Code:&#34;</span><span class=p>,</span> <span class=n>rescode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=k>return</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>def</span> <span class=nf>write_product</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>blogtoken</span><span class=p>,</span> <span class=n>title</span><span class=p>,</span> <span class=n>contents</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=n>blogheader</span> <span class=o>=</span> <span class=s2>&#34;Bearer &#34;</span> <span class=o>+</span> <span class=n>blogtoken</span> <span class=c1># Bearer 다음에 공백 추가</span>
</span></span><span class=line><span class=cl>		<span class=n>blogwriteapi</span> <span class=o>=</span> <span class=s2>&#34;https://openapi.naver.com/blog/writePost.json&#34;</span>
</span></span><span class=line><span class=cl>		<span class=n>blogdata</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;title&#39;</span><span class=p>:</span> <span class=n>title</span><span class=p>,</span> <span class=s1>&#39;contents&#39;</span><span class=p>:</span> <span class=n>contents</span><span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=n>blogheaders</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;Authorization&#39;</span><span class=p>:</span> <span class=n>blogheader</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>blogwriteapi</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>blogheaders</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>blogdata</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>rescode</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=n>rescode</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=nb>id</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>	<span class=n>pw</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>	<span class=n>client_id</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>	<span class=n>client_secret</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>	<span class=n>callback_url</span> <span class=o>=</span> <span class=s1>&#39;http://localhost:8080/&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>nav</span> <span class=o>=</span> <span class=n>naverMgr</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=n>token</span> <span class=o>=</span> <span class=n>nav</span><span class=o>.</span><span class=n>get_logintoken</span><span class=p>(</span><span class=nb>id</span><span class=p>,</span> <span class=n>pw</span><span class=p>,</span> <span class=n>client_id</span><span class=p>,</span> <span class=n>client_secret</span><span class=p>,</span> <span class=n>callback_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>title</span> <span class=o>=</span> <span class=s1>&#39;제목&#39;</span>
</span></span><span class=line><span class=cl>	<span class=n>contents</span> <span class=o>=</span> <span class=s1>&#39;내용&#39;</span>
</span></span><span class=line><span class=cl>	<span class=n>ret</span> <span class=o>=</span> <span class=n>nav</span><span class=o>.</span><span class=n>write_product</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>title</span><span class=p>,</span> <span class=n>contents</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=n>ret</span> <span class=o>==</span> <span class=mi>200</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=nb>print</span><span class=p>(</span><span class=s1>&#39;성공&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nb>print</span><span class=p>(</span><span class=s1>&#39;실패&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>pass</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>테스트한 결과 정상적으로 업로드 잘 되네요.</li></ul><p><img loading=lazy src=/20200202_5.png alt="테스트 결과" title="테스트 결과">
<img loading=lazy src=/20200202_6.png alt="테스트 결과" title="테스트 결과"></p><p>다음 포스트에서 설명할 내용</p><ul><li>다음 포스트에서는 쿠팡의 리뷰 가져오기는 알려드릴 예정입니다.</li><li>혹시나 알려줬으면~ 하는게 있으시면 댓글로 달아 주세요. 모두에게 중요하다 싶은게 있으면 같이 업로드 하겠습니다!</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://jaejin0me.github.io/tags/python/>Python</a></li><li><a href=https://jaejin0me.github.io/tags/%EC%BF%A0%ED%8C%A1%ED%8C%8C%ED%8A%B8%EB%84%88%EC%8A%A4/>쿠팡파트너스</a></li><li><a href=https://jaejin0me.github.io/tags/coupangpartners/>Coupangpartners</a></li></ul></footer><script src=https://utteranc.es/client.js repo=jaejin0me/blog_comment issue-term=title label=comment theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>Jaejin Jang</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>