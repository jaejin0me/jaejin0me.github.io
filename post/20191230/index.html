<!doctype html><html lang=ko dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>파이썬으로 쿠팡 파트너스 API 활용하기 - 1 | Jaejin's blog</title><meta name=keywords content="python,쿠팡파트너스,coupangpartners"><meta name=description content="이력 2019.12.30 포스팅 2020.01.01 수정 - API 호출 횟수 설명 추가 안녕하세요. 쿠팡 파트너스 활동을 시작하면서 파이썬으로 쿠팡 파트너스 API, 네이버 블로그 API를 활용하여 포스팅을 자"><meta name=author content="Jaejin Jang"><link rel=canonical href=https://jaejin0me.github.io/post/20191230/><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://jaejin0me.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jaejin0me.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jaejin0me.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jaejin0me.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jaejin0me.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-F8504X956T"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-F8504X956T",{anonymize_ip:!0})}</script><meta property="og:title" content="파이썬으로 쿠팡 파트너스 API 활용하기 - 1"><meta property="og:description" content="이력 2019.12.30 포스팅 2020.01.01 수정 - API 호출 횟수 설명 추가 안녕하세요. 쿠팡 파트너스 활동을 시작하면서 파이썬으로 쿠팡 파트너스 API, 네이버 블로그 API를 활용하여 포스팅을 자"><meta property="og:type" content="article"><meta property="og:url" content="https://jaejin0me.github.io/post/20191230/"><meta property="article:section" content="post"><meta property="article:published_time" content="2019-12-30T07:12:52+09:00"><meta property="article:modified_time" content="2019-12-30T07:12:52+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="파이썬으로 쿠팡 파트너스 API 활용하기 - 1"><meta name=twitter:description content="이력 2019.12.30 포스팅 2020.01.01 수정 - API 호출 횟수 설명 추가 안녕하세요. 쿠팡 파트너스 활동을 시작하면서 파이썬으로 쿠팡 파트너스 API, 네이버 블로그 API를 활용하여 포스팅을 자"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://jaejin0me.github.io/post/"},{"@type":"ListItem","position":3,"name":"파이썬으로 쿠팡 파트너스 API 활용하기 - 1","item":"https://jaejin0me.github.io/post/20191230/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"파이썬으로 쿠팡 파트너스 API 활용하기 - 1","name":"파이썬으로 쿠팡 파트너스 API 활용하기 - 1","description":"이력 2019.12.30 포스팅 2020.01.01 수정 - API 호출 횟수 설명 추가 안녕하세요. 쿠팡 파트너스 활동을 시작하면서 파이썬으로 쿠팡 파트너스 API, 네이버 블로그 API를 활용하여 포스팅을 자","keywords":["python","쿠팡파트너스","coupangpartners"],"articleBody":"이력\n2019.12.30 포스팅 2020.01.01 수정 - API 호출 횟수 설명 추가 안녕하세요.\n쿠팡 파트너스 활동을 시작하면서 파이썬으로 쿠팡 파트너스 API,\n네이버 블로그 API를 활용하여 포스팅을 자동화 하는 프로그램을 만들었습니다.\nAPI 활용이 어려운건 아니지만 확실한 가이드가 될만한 포스트가 없어서 적어보려고 합니다.\n이 포스팅 시리즈가 끝날때면 기본적인 UI를 갖춘 자동화 프로그램을 완성하는 것을 목표로 하고있습니다.\n​이번 포스트에서 설명할 내용 쿠팡 파트너스 API 활용전에 알아야 할 것 키워드로 상품내용을 받는 API 사용방법(/products/search) 쿠팡 파트너스 가입하기 전이라면 가입하실 때 추천인 적으면 서로 돌려받는 퍼센트가 1% 올라갑니다. 적으실 만한 분이 없다면 추천인 AF0311637 부탁드립니다 :) 활용 대상 쿠팡 파트너스 최종승인이 된 사람!(최종 승인이 되어야 API를 활용할 수 있는 Key가 발급됩니다) 최종 승인이 되는 조건은 쿠팡 파트너스 활동을 통해서 첫 수익이 발생하면 되는 것인데요. 쉽게 말해서 홍보용 포스트을 올렸는데 어떤 사람이 그 포스트를 보고 쿠팡으로 유입되어 물건을 샀을 때입니다. 본인이 사면 안됩니다. (급하신 분은 주변분에게 부탁해서 물건을 사달라고 하시면 될듯?ㅎㅎ) Key가 발급되기 전까지는 수동으로 작업을 하셔야되요. 익숙해지면 쉽습니다^^ 쿠팡 파트너스 API Key 확인 최종 승인이 되면 아래 처럼 추가기능에 파트너스 API 메뉴가 생기고 클릭하면 API Key를 확인할 수 있습니다. 이용가능한 파트너스 API들 https://partners.coupang.com/#help/open-api 제공하는 API 들에 대한 문서가 제공되고 있습니다. 저는 키워드로 검색해서 나오는 상위의 제품들을 홍보하고 있기 때문에 /products/search API를 사용합니다. 하나만 어떻게 사용하는지 익히시면 다른 것들은 쉽게 사용하실 수 있을꺼에요. 문서를 통해 호출하는 URL형식과 필수값은 keyword 인것을 확인할 수 있습니다. 참고 사용하면서 알게된 건데 API는 한시간에 10번만 호출할 수 있습니다. API 사용 흐름 사용할 API 대상으로 HMAC 생성(파트너스 API Key 사용됨) API 호출 결과 확인 쉽죠?. 1번 과정은 정당한 API 사용인지 확인하는거에요. 1번 과정이 없다면 무분별하게 API를 사용하게 되서 API 서비스하는데 어려움이 있겠죠? 1번 과정을 통해 정당한 API 사용임을 입증할 수 있는 값을 받은 다음에 API를 호출하는거에요. 코드로 작성할텐데, 앞으로 포스팅 하면서 조금씩 살을 붙여 나갈꺼에요. 코드를 좀 아시는 분이라면 대충이라도 이해가 될테지만, 지식이 전무하시거나 알 필요도 없으신 분은 그냥 코드복사해서 사용하시면 됩니다. 참고로 파이썬 버전은 v3 입니다. (코드는 기존의 완성된 프로그램[파트너스 api, 네이버 블로그 api, 자동 포스팅]을 편집해서 올리는거라 불필요한 부분이 있을 수도 있지만, 동작테스트는 하고 올리기 때문에 사용하시는데는 문제 없을꺼에요.) 코드 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 # coding: utf-8 import hmac import hashlib import os import time import requests import json import urllib.request from selenium import webdriver import secrets from urllib.parse import urlencode __author__ = \"Jaejin Jang\" class cupangMgr: DOMAIN = \"https://api-gateway.coupang.com\" def generateHmac(self, method, url, secretKey, accessKey): path, *query = url.split(\"?\") os.environ[\"TZ\"] = \"GMT+0\" datetime = time.strftime('%y%m%d')+'T'+time.strftime('%H%M%S')+'Z' message = datetime + method + path + (query[0] if query else \"\") signature = hmac.new(bytes(secretKey, \"utf-8\"), message.encode(\"utf-8\"), hashlib.sha256).hexdigest() return \"CEA algorithm=HmacSHA256, access-key={}, signed-date={}, signature={}\".format(accessKey, datetime, signature) def get_productsdata(self, request_method, authorization, keyword, limit): URL = \"/v2/providers/affiliate_open_api/apis/openapi/products/search?keyword=\" + urllib.parse.quote(keyword) + \"\u0026limit=\" + str(limit) url = \"{}{}\".format(self.DOMAIN, URL) response = requests.request(method=request_method, url=url, headers={ \"Authorization\": authorization, \"Content-Type\": \"application/json;charset=UTF-8\" }) retdata = json.dumps(response.json(), indent=4).encode('utf-8') jsondata = json.loads(retdata) data = jsondata['data'] productdata = data['productData'] return productdata if __name__ == '__main__': method = 'GET'\t#정보를 얻는것이기 때문에 GET keyword = '채워 넣으세요' #검색할 키워드, 쿠팡에서 검색하는거랑 결과가 동일합니다. limit = 5\t#몇개의 정보를 가져올지 설정. 상위부터 가져옵니다. access_key = '채워 넣으세요'\t#API access key secret_key = '채워 넣으세요'\t#API secret key URL = \"/v2/providers/affiliate_open_api/apis/openapi/products/search?keyword=\" + urllib.parse.quote(keyword) + \"\u0026limit=\" + str(limit) test = cupangMgr() authorization = test.generateHmac(method, URL, secret_key, access_key)\t# HMAC 생성 productdata = test.get_productsdata(method, authorization, keyword, limit)\t# API 호출 print(productdata) # 결과 확인 테스트방법 설명 코드의 제일 하단 부분이 테스트하는 코드입니다. 빨간색으로 된 부분을 채워넣고 테스트하시면됩니다. 파란색 부분은 우리가 활용하는 API의 정보입니다. 주황색 부분은 결과출력을 확인하는거에요. 저의 정보를 넣고 테스트해보면 아래와 같이 값이 출력되는 것을 확인할 수 있습니다. 결과를 보면 상품ID, 제목, 가격, 이미지주소, URL, 키워드, 순위, 로켓배송여부​를 확인할 수 있음을 알 수 있습니다. 다음 포스팅에는..\n다음 포스팅에는 결과값으로 해당 상품페이지에 접속해서 이미지를 가져오는 내용을 올리겠습니다. 그 다음에는 네이버 블로그 API로 포스팅 하는 방법을 올릴께요~ 궁금한 점은 댓글로 달아주시면, 시간될 때 성심성의것 답변해 드리겠습니다.\n","wordCount":"1700","inLanguage":"ko","datePublished":"2019-12-30T07:12:52+09:00","dateModified":"2019-12-30T07:12:52+09:00","author":{"@type":"Person","name":"Jaejin Jang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jaejin0me.github.io/post/20191230/"},"publisher":{"@type":"Organization","name":"Jaejin's blog","logo":{"@type":"ImageObject","url":"https://jaejin0me.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jaejin0me.github.io accesskey=h title="Jaejin's blog (Alt + H)">Jaejin's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://jaejin0me.github.io/ title=Home><span>Home</span></a></li><li><a href=https://jaejin0me.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://jaejin0me.github.io/post/ title=Posts><span>Posts</span></a></li><li><a href=https://jaejin0me.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://jaejin0me.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://jaejin0me.github.io/about/ title="About Me"><span>About Me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>파이썬으로 쿠팡 파트너스 API 활용하기 - 1</h1><div class=post-meta><span title='2019-12-30 07:12:52 +0900 +0900'>12월 30, 2019</span>&nbsp;·&nbsp;Jaejin Jang</div></header><div class=post-content><p>이력</p><ul><li>2019.12.30 포스팅</li><li>2020.01.01 수정 - API 호출 횟수 설명 추가</li></ul><p><em>안녕하세요.<br>쿠팡 파트너스 활동을 시작하면서 파이썬으로 쿠팡 파트너스 API,<br>네이버 블로그 API를 활용하여 포스팅을 자동화 하는 프로그램을 만들었습니다.<br>API 활용이 어려운건 아니지만 확실한 가이드가 될만한 포스트가 없어서 적어보려고 합니다.<br>이 포스팅 시리즈가 끝날때면 기본적인 UI를 갖춘 자동화 프로그램을 완성하는 것을 목표로 하고있습니다.</em></p><h1 id=이번-포스트에서-설명할-내용>​이번 포스트에서 설명할 내용<a hidden class=anchor aria-hidden=true href=#이번-포스트에서-설명할-내용>#</a></h1><ul><li>쿠팡 파트너스 API 활용전에 알아야 할 것</li><li>키워드로 상품내용을 받는 API 사용방법(/products/search)</li></ul><h1 id=쿠팡-파트너스-가입하기-전이라면>쿠팡 파트너스 가입하기 전이라면<a hidden class=anchor aria-hidden=true href=#쿠팡-파트너스-가입하기-전이라면>#</a></h1><ul><li>가입하실 때 추천인 적으면 서로 돌려받는 퍼센트가 1% 올라갑니다. 적으실 만한 분이 없다면 추천인 AF0311637 부탁드립니다 :)</li></ul><h1 id=활용-대상>활용 대상<a hidden class=anchor aria-hidden=true href=#활용-대상>#</a></h1><ul><li>쿠팡 파트너스 최종승인이 된 사람!(최종 승인이 되어야 API를 활용할 수 있는 Key가 발급됩니다)</li><li>최종 승인이 되는 조건은 쿠팡 파트너스 활동을 통해서 첫 수익이 발생하면 되는 것인데요. 쉽게 말해서 홍보용 포스트을 올렸는데 어떤 사람이 그 포스트를 보고 쿠팡으로 유입되어 물건을 샀을 때입니다. 본인이 사면 안됩니다. (급하신 분은 주변분에게 부탁해서 물건을 사달라고 하시면 될듯?ㅎㅎ)</li><li>Key가 발급되기 전까지는 수동으로 작업을 하셔야되요. 익숙해지면 쉽습니다^^</li></ul><h1 id=쿠팡-파트너스-api-key-확인>쿠팡 파트너스 API Key 확인<a hidden class=anchor aria-hidden=true href=#쿠팡-파트너스-api-key-확인>#</a></h1><ul><li>최종 승인이 되면 아래 처럼 추가기능에 파트너스 API 메뉴가 생기고 클릭하면 API Key를 확인할 수 있습니다.
<img loading=lazy src=/20191230_1.png alt="API 키 확인" title="API 키 확인"></li></ul><h1 id=이용가능한-파트너스-api들>이용가능한 파트너스 API들<a hidden class=anchor aria-hidden=true href=#이용가능한-파트너스-api들>#</a></h1><ul><li><a href=https://partners.coupang.com/#help/open-api>https://partners.coupang.com/#help/open-api</a></li><li>제공하는 API 들에 대한 문서가 제공되고 있습니다.</li><li>저는 키워드로 검색해서 나오는 상위의 제품들을 홍보하고 있기 때문에 /products/search API를 사용합니다. 하나만 어떻게 사용하는지 익히시면 다른 것들은 쉽게 사용하실 수 있을꺼에요.
<img loading=lazy src=/20191230_2.png alt="API 문서" title="API 문서">
<img loading=lazy src=/20191230_3.png alt="API 문서" title="API 문서"></li><li>문서를 통해 호출하는 URL형식과 필수값은 keyword 인것을 확인할 수 있습니다.</li></ul><h4 id=참고>참고<a hidden class=anchor aria-hidden=true href=#참고>#</a></h4><ul><li>사용하면서 알게된 건데 API는 한시간에 10번만 호출할 수 있습니다.</li></ul><h1 id=api-사용-흐름>API 사용 흐름<a hidden class=anchor aria-hidden=true href=#api-사용-흐름>#</a></h1><ul><li><ol><li>사용할 API 대상으로 HMAC 생성(파트너스 API Key 사용됨)</li></ol></li><li><ol start=2><li>API 호출</li></ol></li><li><ol start=3><li>결과 확인</li></ol></li><li>쉽죠?. 1번 과정은 정당한 API 사용인지 확인하는거에요.</li><li>1번 과정이 없다면 무분별하게 API를 사용하게 되서 API 서비스하는데 어려움이 있겠죠?</li><li>1번 과정을 통해 정당한 API 사용임을 입증할 수 있는 값을 받은 다음에 API를 호출하는거에요.</li><li>코드로 작성할텐데, 앞으로 포스팅 하면서 조금씩 살을 붙여 나갈꺼에요.</li><li>코드를 좀 아시는 분이라면 대충이라도 이해가 될테지만,</li><li>지식이 전무하시거나 알 필요도 없으신 분은 그냥 코드복사해서 사용하시면 됩니다. 참고로 파이썬 버전은 v3 입니다.</li><li>(코드는 기존의 완성된 프로그램[파트너스 api, 네이버 블로그 api, 자동 포스팅]을 편집해서 올리는거라 불필요한 부분이 있을 수도 있지만, 동작테스트는 하고 올리기 때문에 사용하시는데는 문제 없을꺼에요.)</li></ul><h1 id=코드>코드<a hidden class=anchor aria-hidden=true href=#코드>#</a></h1><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># coding: utf-8</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>urllib.request</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>secrets</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>urllib.parse</span> <span class=kn>import</span> <span class=n>urlencode</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>__author__</span> <span class=o>=</span> <span class=s2>&#34;Jaejin Jang&lt;jaejin_me@naver.com&gt;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>cupangMgr</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=n>DOMAIN</span> <span class=o>=</span> <span class=s2>&#34;https://api-gateway.coupang.com&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>def</span> <span class=nf>generateHmac</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>method</span><span class=p>,</span> <span class=n>url</span><span class=p>,</span> <span class=n>secretKey</span><span class=p>,</span> <span class=n>accessKey</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=n>path</span><span class=p>,</span> <span class=o>*</span><span class=n>query</span> <span class=o>=</span> <span class=n>url</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;?&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s2>&#34;TZ&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;GMT+0&#34;</span>
</span></span><span class=line><span class=cl>		<span class=n>datetime</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%y%m</span><span class=si>%d</span><span class=s1>&#39;</span><span class=p>)</span><span class=o>+</span><span class=s1>&#39;T&#39;</span><span class=o>+</span><span class=n>time</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%H%M%S&#39;</span><span class=p>)</span><span class=o>+</span><span class=s1>&#39;Z&#39;</span>
</span></span><span class=line><span class=cl>		<span class=n>message</span> <span class=o>=</span> <span class=n>datetime</span> <span class=o>+</span> <span class=n>method</span> <span class=o>+</span> <span class=n>path</span> <span class=o>+</span> <span class=p>(</span><span class=n>query</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>if</span> <span class=n>query</span> <span class=k>else</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>signature</span> <span class=o>=</span> <span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=nb>bytes</span><span class=p>(</span><span class=n>secretKey</span><span class=p>,</span> <span class=s2>&#34;utf-8&#34;</span><span class=p>),</span> <span class=n>message</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>),</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=s2>&#34;CEA algorithm=HmacSHA256, access-key=</span><span class=si>{}</span><span class=s2>, signed-date=</span><span class=si>{}</span><span class=s2>, signature=</span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>accessKey</span><span class=p>,</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>signature</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>def</span> <span class=nf>get_productsdata</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request_method</span><span class=p>,</span> <span class=n>authorization</span><span class=p>,</span> <span class=n>keyword</span><span class=p>,</span> <span class=n>limit</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=n>URL</span> <span class=o>=</span> <span class=s2>&#34;/v2/providers/affiliate_open_api/apis/openapi/products/search?keyword=&#34;</span> <span class=o>+</span> <span class=n>urllib</span><span class=o>.</span><span class=n>parse</span><span class=o>.</span><span class=n>quote</span><span class=p>(</span><span class=n>keyword</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;&amp;limit=&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>limit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=si>{}{}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>DOMAIN</span><span class=p>,</span> <span class=n>URL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>request</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=n>request_method</span><span class=p>,</span> <span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=p>{</span> <span class=s2>&#34;Authorization&#34;</span><span class=p>:</span> <span class=n>authorization</span><span class=p>,</span> <span class=s2>&#34;Content-Type&#34;</span><span class=p>:</span> <span class=s2>&#34;application/json;charset=UTF-8&#34;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>		<span class=n>retdata</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>(),</span> <span class=n>indent</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>jsondata</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>retdata</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>data</span> <span class=o>=</span> <span class=n>jsondata</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>		<span class=n>productdata</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;productData&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=n>productdata</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=n>method</span> <span class=o>=</span> <span class=s1>&#39;GET&#39;</span>				 <span class=c1>#정보를 얻는것이기 때문에 GET</span>
</span></span><span class=line><span class=cl>	<span class=n>keyword</span> <span class=o>=</span> <span class=s1>&#39;채워 넣으세요&#39;</span> <span class=c1>#검색할 키워드, 쿠팡에서 검색하는거랑 결과가 동일합니다.</span>
</span></span><span class=line><span class=cl>	<span class=n>limit</span> <span class=o>=</span> <span class=mi>5</span>					 <span class=c1>#몇개의 정보를 가져올지 설정. 상위부터 가져옵니다.</span>
</span></span><span class=line><span class=cl>	<span class=n>access_key</span> <span class=o>=</span> <span class=s1>&#39;채워 넣으세요&#39;</span>			<span class=c1>#API access key</span>
</span></span><span class=line><span class=cl>	<span class=n>secret_key</span> <span class=o>=</span> <span class=s1>&#39;채워 넣으세요&#39;</span>		<span class=c1>#API secret key</span>
</span></span><span class=line><span class=cl>	<span class=n>URL</span> <span class=o>=</span> <span class=s2>&#34;/v2/providers/affiliate_open_api/apis/openapi/products/search?keyword=&#34;</span> <span class=o>+</span> <span class=n>urllib</span><span class=o>.</span><span class=n>parse</span><span class=o>.</span><span class=n>quote</span><span class=p>(</span><span class=n>keyword</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;&amp;limit=&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>limit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>test</span> <span class=o>=</span> <span class=n>cupangMgr</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=n>authorization</span> <span class=o>=</span> <span class=n>test</span><span class=o>.</span><span class=n>generateHmac</span><span class=p>(</span><span class=n>method</span><span class=p>,</span> <span class=n>URL</span><span class=p>,</span> <span class=n>secret_key</span><span class=p>,</span> <span class=n>access_key</span><span class=p>)</span>		<span class=c1># HMAC 생성</span>
</span></span><span class=line><span class=cl>	<span class=n>productdata</span> <span class=o>=</span> <span class=n>test</span><span class=o>.</span><span class=n>get_productsdata</span><span class=p>(</span><span class=n>method</span><span class=p>,</span> <span class=n>authorization</span><span class=p>,</span> <span class=n>keyword</span><span class=p>,</span> <span class=n>limit</span><span class=p>)</span>	<span class=c1># API 호출</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=n>productdata</span><span class=p>)</span> <span class=c1># 결과 확인</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=테스트방법-설명>테스트방법 설명<a hidden class=anchor aria-hidden=true href=#테스트방법-설명>#</a></h1><ul><li>코드의 제일 하단 부분이 테스트하는 코드입니다.</li><li>빨간색으로 된 부분을 채워넣고 테스트하시면됩니다.</li><li>파란색 부분은 우리가 활용하는 API의 정보입니다.</li><li>주황색 부분은 결과출력을 확인하는거에요.</li><li>저의 정보를 넣고 테스트해보면 아래와 같이 값이 출력되는 것을 확인할 수 있습니다.</li><li>결과를 보면 상품ID, 제목, 가격, 이미지주소, URL, 키워드, 순위, 로켓배송여부​를 확인할 수 있음을 알 수 있습니다.
<img loading=lazy src=/20191230_4.png alt=결과 title=결과></li></ul><p>다음 포스팅에는..</p><ul><li>다음 포스팅에는 결과값으로 해당 상품페이지에 접속해서 이미지를 가져오는 내용을 올리겠습니다.</li><li>그 다음에는 네이버 블로그 API로 포스팅 하는 방법을 올릴께요~</li></ul><p>궁금한 점은 댓글로 달아주시면, 시간될 때 성심성의것 답변해 드리겠습니다.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://jaejin0me.github.io/tags/python/>python</a></li><li><a href=https://jaejin0me.github.io/tags/%EC%BF%A0%ED%8C%A1%ED%8C%8C%ED%8A%B8%EB%84%88%EC%8A%A4/>쿠팡파트너스</a></li><li><a href=https://jaejin0me.github.io/tags/coupangpartners/>coupangpartners</a></li></ul></footer></article></main><footer class=footer><span>Jaejin Jang</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>